---
export async function getStaticPaths() {
  // Get all sustainability items to create redirects for
  const { getCollection } = await import("astro:content");
  const sustainabilityEntries = await getCollection("sustainability", ({ id }) =>
    id.startsWith("fr/")
  );
  
  return sustainabilityEntries.map((sustainability) => {
    const idWithoutLang = sustainability.id.replace(/^fr\//, "");
    return {
      params: { id: idWithoutLang },
      props: { redirectTo: `/sustainability/${idWithoutLang}` },
    };
  });
}

const { redirectTo } = Astro.props;
---

<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="refresh" content={`0;url=${redirectTo}`} />
  <title>Redirection...</title>
</head>
<body>
  <p>Redirection vers <a href={redirectTo}>{redirectTo}</a>...</p>
  <script>
    window.location.href = '{redirectTo}';
  </script>
</body>
</html>
